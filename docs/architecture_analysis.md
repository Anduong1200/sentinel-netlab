# PhÃ¢n TÃ­ch Kiáº¿n TrÃºc - WiFi Security Assessment System

## 1. So sÃ¡nh PhÆ°Æ¡ng Ã¡n

| TiÃªu chÃ­ | WSL2 | VirtualBox/VMware VM |
|----------|------|---------------------|
| Monitor Mode | âŒ KhÃ³ (cáº§n custom kernel) | âœ… Dá»… (native support) |
| USB Passthrough | ðŸŸ¡ usbipd (phá»©c táº¡p) | âœ… Native (Ä‘Æ¡n giáº£n) |
| Driver Support | âŒ Háº¡n cháº¿ | âœ… Äáº§y Ä‘á»§ (Kali cÃ³ sáºµn) |
| Performance | âœ… Tá»‘t | ðŸŸ¡ KhÃ¡ (VM overhead) |
| Setup Time | âŒ LÃ¢u (build kernel) | âœ… Nhanh (import OVA) |
| Stability | âŒ KhÃ´ng á»•n Ä‘á»‹nh | âœ… á»”n Ä‘á»‹nh |

**Káº¿t luáº­n:** Chá»n **VirtualBox/VMware VM** cho Ä‘á»™ á»•n Ä‘á»‹nh vÃ  dá»… triá»ƒn khai.

---

## 2. Kiáº¿n TrÃºc Há»‡ Thá»‘ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     WINDOWS HOST                                 â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚     CONTROLLER         â”‚  HTTP  â”‚       LINUX VM            â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  REST  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚  scanner_gui.py  â”‚â—„â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–ºâ”‚   api_server.py     â”‚  â”‚â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚  :5000 â”‚  â”‚                     â”‚  â”‚â”‚
â”‚  â”‚  â”‚  - Tkinter UI    â”‚  â”‚        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚â”‚
â”‚  â”‚  â”‚  - Risk Display  â”‚  â”‚        â”‚  â”‚  â”‚  capture.py   â”‚  â”‚  â”‚â”‚
â”‚  â”‚  â”‚  - Export        â”‚  â”‚        â”‚  â”‚  â”‚  - Monitor    â”‚  â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚  â”‚  â”‚  - Ch Hop     â”‚  â”‚  â”‚â”‚
â”‚  â”‚                        â”‚        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚  â”‚          â”‚          â”‚  â”‚â”‚
â”‚  â”‚  â”‚   api_client.py  â”‚  â”‚        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚â”‚
â”‚  â”‚  â”‚   (planned)      â”‚  â”‚        â”‚  â”‚  â”‚  parser.py    â”‚  â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚  â”‚  â”‚  - 802.11     â”‚  â”‚  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚  â”‚  - OUI        â”‚  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚          â”‚          â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â”‚  storage.py   â”‚  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â”‚  - SQLite     â”‚  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â”‚  - PCAP       â”‚  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚                     â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â”‚  risk.py      â”‚  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â”‚  config.py    â”‚  â”‚  â”‚â”‚
â”‚                                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚â”‚
â”‚                                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚                                    â”‚           â”‚               â”‚â”‚
â”‚                                    â”‚    USB Passthrough        â”‚â”‚
â”‚                                    â”‚           â”‚               â”‚â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    USB WiFi Adapter                          â”‚â”‚
â”‚  â”‚                 (Atheros AR9271 - TL-WN722N v1)              â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Data Flow

```mermaid
sequenceDiagram
    participant U as User (GUI)
    participant C as Controller
    participant A as API Server
    participant P as Parser
    participant S as Storage

    U->>C: Click "Start Scan"
    C->>A: GET /scan
    A->>A: Enable Monitor Mode
    A->>A: Channel Hopping
    A->>P: Process Packets
    P->>P: Parse 802.11 Frames
    P->>A: Return Networks
    A->>S: Store to SQLite
    A->>C: JSON Response
    C->>U: Display in Treeview
```

---

## 4. Báº£o máº­t

| Layer | Mechanism |
|-------|-----------|
| Transport | HTTP (dev) / HTTPS (prod) |
| Authentication | X-API-Key header |
| Rate Limiting | 60 req/min |
| Input Validation | Flask validators |

---

## 5. Deployment Options

### Development
- VirtualBox NAT + Port Forwarding
- Flask debug mode

### Production
- VMware Bridged Network
- gunicorn + nginx
- TLS certificates
- systemd service

---

## 6. Files Reference

| File | Purpose |
|------|---------|
| `sensor/api_server.py` | Flask REST API |
| `sensor/capture.py` | Monitor mode, channel hopping |
| `sensor/parser.py` | 802.11 frame parsing |
| `sensor/storage.py` | SQLite, PCAP management |
| `sensor/risk.py` | Risk scoring algorithm |
| `sensor/config.py` | Configuration |
| `controller/scanner_gui.py` | Tkinter GUI |
