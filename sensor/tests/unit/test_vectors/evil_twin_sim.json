{
    "description": "Test vectors for evil_twin_sim.pcap - duplicate SSID from different BSSIDs",
    "pcap": "evil_twin_sim.pcap",
    "matching_rules": {
        "timestamp_tolerance_ms": 500,
        "rssi_tolerance_db": 3
    },
    "detection_rules": {
        "evil_twin": {
            "condition": "duplicate_ssid_different_bssid",
            "rssi_delta_threshold_db": 20,
            "flag": "evil_twin_detected"
        }
    },
    "vectors": [
        {
            "id": "evil_twin_2.1",
            "note": "Legit AP baseline",
            "expected": {
                "frame_type": "beacon",
                "bssid": "10:aa:10:aa:10:aa",
                "ssid": "CorpGuest",
                "rssi_dbm": -62,
                "channel": 6,
                "frequency_mhz": 2437,
                "vendor_oui": "10:aa:10",
                "capabilities": {
                    "privacy": true,
                    "ht": true,
                    "pmf": false,
                    "ies_present": [
                        "RSN",
                        "HT"
                    ]
                },
                "ie": {
                    "rsn": {
                        "cipher_suites": [
                            "CCMP"
                        ],
                        "akm": [
                            "PSK"
                        ]
                    }
                }
            }
        },
        {
            "id": "evil_twin_2.2",
            "note": "Evil twin: same SSID 'CorpGuest', different BSSID & vendor, higher RSSI",
            "expected": {
                "frame_type": "beacon",
                "bssid": "b0:bb:b0:bb:b0:bb",
                "ssid": "CorpGuest",
                "rssi_dbm": -30,
                "channel": 6,
                "frequency_mhz": 2437,
                "vendor_oui": "b0:bb:b0",
                "capabilities": {
                    "privacy": false,
                    "ht": false,
                    "pmf": false,
                    "ies_present": [
                        "Vendor_Specific"
                    ]
                },
                "ie": {
                    "vendor_specific": {
                        "note": "likely fake beacon generator"
                    }
                }
            },
            "detection_hint": "duplicate SSID + RSSI_delta > 20 dB => Evil Twin flag"
        },
        {
            "id": "evil_twin_2.3",
            "note": "Beacon interval anomaly sample for behavioral detection",
            "expected": {
                "frame_type": "beacon",
                "bssid": "b0:bb:b0:bb:b0:bb",
                "ssid": "CorpGuest",
                "capabilities": {
                    "ies_present": [
                        "Vendor_Specific"
                    ]
                },
                "ie": {
                    "vendor_specific": {
                        "beacon_interval_ms_observed": [
                            98,
                            102,
                            97
                        ]
                    }
                }
            }
        }
    ]
}